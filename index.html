<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gamifica√ß√£o - Demonstra√ß√£o</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .config-selector {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .config-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .config-btn {
            padding: 15px 20px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .config-btn:hover {
            background: linear-gradient(45deg, #5a6fd8, #6a4190);
            transform: translateY(-2px);
        }

        .config-btn.active {
            background: linear-gradient(45deg, #28a745, #20c997);
        }

        .game-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            overflow: hidden;
            display: none;
        }

        .game-container.active {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .game-header {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .game-title {
            font-size: 2rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .game-subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .status-bar {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            text-align: center;
            color: white;
            font-weight: bold;
        }

        .progress-section {
            padding: 40px;
        }

        .progress-map {
            position: relative;
            min-height: 600px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .module {
            position: absolute;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            font-size: 1.5rem;
            font-weight: bold;
            text-decoration: none;
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 10;
        }

        .module:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .module.available {
            background: linear-gradient(45deg, #28a745, #20c997);
            animation: pulse 2s infinite;
        }

        .module.locked {
            background: linear-gradient(45deg, #6c757d, #495057);
            cursor: not-allowed;
            opacity: 0.7;
        }

        .module.completed {
            background: linear-gradient(45deg, #007bff, #0056b3);
        }

        .module.current {
            background: linear-gradient(45deg, #ffc107, #e0a800);
            border-color: #fff;
            animation: glow 1.5s ease-in-out infinite alternate;
        }

        .module.checkpoint {
            background: linear-gradient(45deg, #17a2b8, #138496);
            width: 100px;
            height: 100px;
            border: 4px solid #fff;
        }

        @keyframes pulse {
            0% { box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
            50% { box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4); }
            100% { box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        }

        @keyframes glow {
            from { 
                box-shadow: 0 8px 25px rgba(255, 193, 7, 0.4);
                border-color: rgba(255, 255, 255, 0.8);
            }
            to { 
                box-shadow: 0 12px 35px rgba(255, 193, 7, 0.8);
                border-color: rgba(255, 255, 255, 1);
            }
        }

        .content-panel {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            display: none;
        }

        .content-panel.active {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        .content-title {
            font-size: 1.8rem;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .content-description {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 20px;
        }

        .content-body {
            font-size: 1rem;
            line-height: 1.6;
            color: #444;
            margin-bottom: 30px;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-success {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(45deg, #6c757d, #495057);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .module-tooltip {
            position: absolute;
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.9rem;
            white-space: nowrap;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .module-tooltip.show {
            opacity: 1;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .config-buttons {
                grid-template-columns: 1fr;
            }
            
            .module {
                width: 60px;
                height: 60px;
                font-size: 1.2rem;
            }
            
            .module.checkpoint {
                width: 80px;
                height: 80px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéÆ Sistema de Gamifica√ß√£o</h1>
            <p>Demonstra√ß√£o interativa do sistema de aprendizado progressivo</p>
        </div>

        <div class="config-selector">
            <h3>üìã Selecione uma Configura√ß√£o para Testar:</h3>
            <div class="config-buttons">
                <button class="config-btn" onclick="loadConfig('teste')">
                    üß™ Teste (2 m√≥dulos)
                </button>
                <button class="config-btn" onclick="loadConfig('simples')">
                    üöÄ Simples (4 m√≥dulos)
                </button>
                <button class="config-btn" onclick="loadConfig('completa')">
                    üìö Completa (11 m√≥dulos)
                </button>
            </div>
        </div>

        <div class="game-container" id="gameContainer">
            <div class="game-header">
                <h2 class="game-title" id="gameTitle">Sistema de Gamifica√ß√£o</h2>
                <div class="game-subtitle" id="gameSubtitle">Carregando...</div>
            </div>

            <div class="status-bar" id="statusBar">
                Preparando sistema...
            </div>

            <div class="progress-section">
                <div class="progress-map" id="progressMap"></div>

                <div class="content-panel" id="contentPanel">
                    <div class="content-title" id="contentTitle"></div>
                    <div class="content-description" id="contentDescription"></div>
                    <div class="content-body" id="contentBody"></div>
                    <div class="action-buttons" id="actionButtons"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="module-tooltip" id="tooltip"></div>

    <script>
        // Mapeamento dos tipos de configura√ß√£o para arquivos JSON
        const configFiles = {
            teste: './config-teste.json',
            simples: './config-simples.json',
            completa: './config-completa.json'
        };

        let currentConfig = null;
        let currentModule = null;

        async function loadConfig(configType) {
            try {
                // Mostra loading
                showLoadingState(configType);
                
                // Carrega configura√ß√£o do arquivo JSON
                const response = await fetch(configFiles[configType]);
                if (!response.ok) {
                    throw new Error(`Erro HTTP ${response.status}: ${response.statusText}`);
                }
                
                currentConfig = await response.json();
                
                // Atualiza bot√µes
                document.querySelectorAll('.config-btn').forEach(btn => btn.classList.remove('active'));
                event.target.classList.add('active');
                
                // Atualiza interface
                document.getElementById('gameTitle').textContent = currentConfig.title;
                document.getElementById('gameSubtitle').textContent = 
                    `${Object.keys(currentConfig.modules).length} m√≥dulos dispon√≠veis`;
                
                // Mostra container do jogo
                document.getElementById('gameContainer').classList.add('active');
                
                // Gera mapa
                generateProgressMap();
                updateStatusBar();
                
                // Fecha painel de conte√∫do se estiver aberto
                closeContentPanel();
                
            } catch (error) {
                console.error('Erro ao carregar configura√ß√£o:', error);
                showErrorState(configType, error.message);
            }
        }

        function showLoadingState(configType) {
            const gameContainer = document.getElementById('gameContainer');
            gameContainer.classList.add('active');
            
            document.getElementById('gameTitle').textContent = `Carregando ${configType}...`;
            document.getElementById('gameSubtitle').textContent = 'Aguarde enquanto carregamos a configura√ß√£o';
            document.getElementById('statusBar').textContent = '‚è≥ Carregando dados...';
            
            const mapContainer = document.getElementById('progressMap');
            mapContainer.innerHTML = `
                <div style="display: flex; align-items: center; justify-content: center; height: 100%; font-size: 1.2rem; color: #666;">
                    <div style="text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 20px;">üîÑ</div>
                        <div>Carregando configura√ß√£o...</div>
                    </div>
                </div>
            `;
        }

        function showErrorState(configType, errorMessage) {
            document.getElementById('gameTitle').textContent = '‚ùå Erro ao Carregar';
            document.getElementById('gameSubtitle').textContent = `Falha ao carregar ${configType}`;
            document.getElementById('statusBar').textContent = '‚ùå Erro na configura√ß√£o';
            
            const mapContainer = document.getElementById('progressMap');
            mapContainer.innerHTML = `
                <div style="display: flex; align-items: center; justify-content: center; height: 100%; font-size: 1.1rem; color: #dc3545;">
                    <div style="text-align: center; background: #f8d7da; padding: 30px; border-radius: 10px; border: 1px solid #f5c6cb;">
                        <div style="font-size: 3rem; margin-bottom: 20px;">‚ö†Ô∏è</div>
                        <div style="font-weight: bold; margin-bottom: 10px;">Erro ao Carregar Configura√ß√£o</div>
                        <div style="margin-bottom: 15px;">Arquivo: <code>${configFiles[configType]}</code></div>
                        <div style="font-size: 0.9rem; color: #721c24;">${errorMessage}</div>
                        <div style="margin-top: 15px; font-size: 0.8rem;">
                            üí° Certifique-se de que os arquivos JSON est√£o no mesmo diret√≥rio
                        </div>
                    </div>
                </div>
            `;
        }

        function generateProgressMap() {
            const mapContainer = document.getElementById('progressMap');
            mapContainer.innerHTML = '';

            // Cria SVG para as linhas
            const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            svg.style.position = 'absolute';
            svg.style.top = '0';
            svg.style.left = '0';
            svg.style.width = '100%';
            svg.style.height = '100%';
            svg.style.zIndex = '1';
            svg.style.pointerEvents = 'none';
            mapContainer.appendChild(svg);

            // Gera m√≥dulos
            Object.entries(currentConfig.modules).forEach(([id, module]) => {
                const moduleElement = createModuleElement(id, module);
                mapContainer.appendChild(moduleElement);
            });

            // Cria conex√µes como linhas SVG
            if (currentConfig.connections) {
                currentConfig.connections.forEach(connection => {
                    createSVGLine(svg, connection.from, connection.to);
                });
            }
        }

        function createSVGLine(svg, fromId, toId) {
            const fromModule = currentConfig.modules[fromId];
            const toModule = currentConfig.modules[toId];
            
            if (!fromModule || !toModule) return null;

            const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            line.setAttribute('x1', `${fromModule.position.x}%`);
            line.setAttribute('y1', `${fromModule.position.y}%`);
            line.setAttribute('x2', `${toModule.position.x}%`);
            line.setAttribute('y2', `${toModule.position.y}%`);
            line.setAttribute('stroke', '#667eea');
            line.setAttribute('stroke-width', '4');
            line.setAttribute('stroke-linecap', 'round');
            line.setAttribute('opacity', '0.8');

            svg.appendChild(line);
            return line;
        }

        function createModuleElement(id, module) {
            const element = document.createElement('div');
            element.className = 'module';
            element.id = `module-${id}`;
            element.style.left = `${module.position.x}%`;
            element.style.top = `${module.position.y}%`;
            element.style.transform = 'translate(-50%, -50%)';
            
            // Determina o estado do m√≥dulo
            let state = 'locked';
            if (module.isCompleted) {
                state = 'completed';
            } else if (module.isAvailable) {
                state = 'available';
            }
            
            if (module.type === 'checkpoint') {
                element.classList.add('checkpoint');
            }
            
            element.classList.add(state);
            
            // Emoji baseado no tipo e estado
            let emoji = 'üìö';
            if (module.type === 'checkpoint') {
                emoji = 'üéØ';
            } else if (state === 'completed') {
                emoji = '‚úÖ';
            } else if (state === 'locked') {
                emoji = 'üîí';
            }
            
            element.textContent = emoji;
            
            // Event listeners
            if (state !== 'locked') {
                element.addEventListener('click', () => selectModule(id));
            }
            
            element.addEventListener('mouseenter', (e) => showTooltip(e, module));
            element.addEventListener('mouseleave', hideTooltip);
            
            return element;
        }

        function selectModule(moduleId) {
            currentModule = moduleId;
            const module = currentConfig.modules[moduleId];
            
            // Atualiza painel de conte√∫do
            document.getElementById('contentTitle').textContent = module.title;
            document.getElementById('contentDescription').textContent = module.description;
            document.getElementById('contentBody').textContent = module.content;
            
            // Bot√µes de a√ß√£o
            const buttonsContainer = document.getElementById('actionButtons');
            buttonsContainer.innerHTML = '';
            
            if (!module.isCompleted && module.type !== 'checkpoint') {
                const completeBtn = document.createElement('button');
                completeBtn.className = 'btn btn-success';
                completeBtn.innerHTML = '‚úÖ Marcar como Conclu√≠do';
                completeBtn.onclick = () => completeModule(moduleId);
                buttonsContainer.appendChild(completeBtn);
            }
            
            const closeBtn = document.createElement('button');
            closeBtn.className = 'btn btn-secondary';
            closeBtn.innerHTML = '‚úñÔ∏è Fechar';
            closeBtn.onclick = closeContentPanel;
            buttonsContainer.appendChild(closeBtn);
            
            // Mostra painel
            document.getElementById('contentPanel').classList.add('active');
            
            // Atualiza estado visual
            document.querySelectorAll('.module').forEach(el => el.classList.remove('current'));
            document.getElementById(`module-${moduleId}`).classList.add('current');
        }

        function completeModule(moduleId) {
            const module = currentConfig.modules[moduleId];
            module.isCompleted = true;
            
            // Desbloqueia m√≥dulos dependentes
            Object.entries(currentConfig.modules).forEach(([id, mod]) => {
                if (mod.dependencies && mod.dependencies.includes(moduleId)) {
                    const allDependenciesMet = mod.dependencies.every(depId => 
                        currentConfig.modules[depId].isCompleted || currentConfig.modules[depId].type === 'checkpoint'
                    );
                    if (allDependenciesMet) {
                        mod.isAvailable = true;
                    }
                }
            });
            
            // Atualiza interface
            generateProgressMap();
            updateStatusBar();
            closeContentPanel();
            
            // Notifica√ß√£o
            showNotification(`üéâ ${module.title} conclu√≠do!`);
        }

        function closeContentPanel() {
            document.getElementById('contentPanel').classList.remove('active');
            document.querySelectorAll('.module').forEach(el => el.classList.remove('current'));
            currentModule = null;
        }

        function showTooltip(event, module) {
            const tooltip = document.getElementById('tooltip');
            tooltip.textContent = `${module.title} - ${module.description}`;
            tooltip.style.left = event.pageX + 10 + 'px';
            tooltip.style.top = event.pageY - 30 + 'px';
            tooltip.classList.add('show');
        }

        function hideTooltip() {
            document.getElementById('tooltip').classList.remove('show');
        }

        function updateStatusBar() {
            if (!currentConfig) return;
            
            const modules = Object.values(currentConfig.modules);
            const contentModules = modules.filter(m => m.type !== 'checkpoint');
            const completed = contentModules.filter(m => m.isCompleted).length;
            const available = contentModules.filter(m => m.isAvailable && !m.isCompleted).length;
            
            const statusText = `üìä Progresso: ${completed}/${contentModules.length} conclu√≠dos ‚Ä¢ ${available} dispon√≠veis`;
            document.getElementById('statusBar').textContent = statusText;
        }

        function showNotification(message) {
            // Cria notifica√ß√£o tempor√°ria
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(45deg, #28a745, #20c997);
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                font-weight: bold;
                z-index: 10000;
                animation: slideInRight 0.3s ease-out;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease-in';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Atalhos de teclado
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeContentPanel();
            }
        });

        // Adiciona estilos de anima√ß√£o
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
